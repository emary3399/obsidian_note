
## 🎯 一句话定义：

> **`SET` 是一种用于“从多个预定义选项中选择**一个或多个**”的字符串类型。**

---

## 📚 举例说明（从日常说起）：

假设你设计一个表格，记录一个用户的兴趣爱好，选项如下：

```sql
'旅游', '美食', '阅读', '运动', '音乐', '电影'
```

用 `SET` 类型定义字段后，用户可以选择：

- 只选一个：'美食'
    
- 选多个：'美食,电影,旅游'
    
- 不选（空字符串）
    

这在 `ENUM` 中是做不到的，`ENUM` 只能存一个值。

---

## ✅ 优点汇总

|优点|说明|
|---|---|
|✅ 多选灵活|比 `ENUM` 更强大，可选 0~64 个（MySQL 限制）|
|✅ 查询高效|内部是用 **位运算存储**，性能好|
|✅ 空间节省|不用建多对多表，节省结构设计和 JOIN 查询成本|
|✅ 强类型校验|非法值不能插入，防止脏数据|

---

## ⚠️ 注意事项（你需要避开的坑）

|问题|说明|
|---|---|
|⛔ SET 不是数组|它是 **以逗号分隔的字符串集合**|
|⛔ 最大只能有 64 个选项|因为底层用 64 位来表示每个选项是否被选|
|⛔ 查询不太直观|需要用 `FIND_IN_SET()` 或 `LIKE`|
|⛔ 修改选项麻烦|像 `ENUM` 一样，一改就要 `ALTER TABLE`|

---

## 🧪 创建示例（兴趣多选）

```sql
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50),
    hobbies SET('旅游', '美食', '阅读', '运动', '音乐', '电影')
);
```

插入数据：

```sql
INSERT INTO users (name, hobbies) VALUES ('张三', '美食,电影');
INSERT INTO users (name, hobbies) VALUES ('李四', '旅游,运动,阅读');
```

---

## 🔍 查询技巧

查找所有“包含电影”的用户：

```sql
SELECT * FROM users WHERE FIND_IN_SET('电影', hobbies);
```

查找同时喜欢“旅游”和“美食”的用户（包含这两个）：

```sql
SELECT * FROM users 
WHERE FIND_IN_SET('旅游', hobbies) AND FIND_IN_SET('美食', hobbies);
```

---

## 🔑 SET 背后底层机制：位运算！

比如：

```sql
SET('旅游', '美食', '阅读', '运动')
```

每个选项其实占用一个比特位：

|选项|二进制位置|十进制值|
|---|---|---|
|旅游|0001|1|
|美食|0010|2|
|阅读|0100|4|
|运动|1000|8|

选了 `旅游` + `阅读`，它的值就是 `0001 | 0100 = 0101 = 5`

---

## 🧠 SET 和 ENUM 区别小总结：

|对比点|ENUM|SET|
|---|---|---|
|选项数量|单选|多选|
|存储方式|数值编号|位运算|
|用途|状态、类型字段|标签、兴趣、权限|
|查询难度|简单|稍复杂|
|最大选项数|65535 个|最多 64 个|

---

## 🧩 使用建议：

- ✅ 选项数量 ≤ 10，且会同时选多个：**SET 是性价比最高的方案**
    
- ❌ 如果选项经常变化、不固定：**别用 SET，改用多对多关联表**
    
- ❌ 如果需要高可移植性、JSON 友好：**考虑用 `VARCHAR + JSON` 或 `数组字段（PostgreSQL 支持）`**
    

---

## 🧠 总结口诀：

> **“单选用 ENUM，多选靠 SET，选项不多省结构，查询稍麻烦。”**

---

