2020 年试题五（共 15 分） 
阅读下列说明，回答问题 1 至问题 3，将解答填入答题纸的对应栏内。
【说明】 如果一个数据库恢复系统采用检查点机制，且其日志文件如表 5-1 所示，第一列表示日志记录编号，第二列表示日志记录内容，表示事务 Ti 开始执行，表示事务 Ti 提交，表示事务 Ti 将数据项 D 的值由 V1 修改为V2，请回答以下问题。

| LSN   | 日志记录内容          | 说明            |
| ----- | --------------- | ------------- |
| LSN1  | <T1, START>     | 事务T1开始        |
| LSN2  | <T1, X, 100, 1> | 事务T1将X从100改为1 |
| LSN3  | <T2, START>     | 事务T2开始        |
| LSN4  | <T2, X, 1, 3>   | 事务T2将X从1改为3   |
| LSN5  | <T3, START>     | 事务T3开始        |
| LSN6  | <T2, Y, 50, 6>  | 事务T2将Y从50改为6  |
| LSN7  | <T3, Y, 6, 8>   | 事务T3将Y从6改为8   |
| LSN8  | <T3, Z, 10, 9>  | 事务T3将Z从10改为9  |
| LSN9  | CHECKPOINT      | 检查点           |
| LSN10 | <T1, COMMIT>    | 事务T1提交        |
| LSN11 | <T3, Z, 9, 10>  | 事务T3将Z从9改为10  |
| LSN12 | CRASH           | 系统崩溃          |


【问题 1】（6 分） 假设系统开始执行前 X=100, Y=50, Z=10，系统出错恢复后，X，Y，Z 各自的数值是多少？
- **X = 1**
- **Y = 50**
- **Z = 10**

【问题 2】（4 分） 系统发生事务故障时，故障恢复有撤销事务（UNDO）和重做事务（REDO）两个操作，请给出系统恢复时需要 REDO 的事务列表和需要 UNDO 的事务列表。
- **REDO 列表：T1**
- **UNDO 列表：T2, T3**

【问题 3】（5 分） 请简要描述系统出错后，基于检查点的恢复过程。
1. 发生故障后，反向扫描日志文件。
2. 扫描至检查点，确认当前活动事务为 T1,T2,T3。
3. 检查点之后 T1 事务提交了，因此要重做（REDO），方法是从 T1 事务的开始标记起，正向扫描日志文件，重新执行 T1 对数据库的所有操作，直到事务结束标志。
4. 检查点后 T2、T3 未提交，因此要撤销（UNDO），方法是反向扫描日志文件，将T2 和T3对数据库的所有更新操作执行逆操作，直到事务开始标志。
5. 验证数据最终状态，完成恢复并确保一致性。