2023 年试题五（共 15 分）
阅读下列说明，回答问题 1 至问题 4，将解答填入答题纸的对应栏内。
【说明】
某装备的组装过程需要经过多道程序，由于工作空间狭小，同时只能有一人在操作间工作，所以在每道工序之间需要先完成使用配件的出库后，操作人员携带配件到操作间进行安装工作，安装过程中需要扫描配件编码以自动记录该配件的安装情况。 假设存在三个事务用于处理某一类配件的某次安装实施，事务 T1 负责出库登记，T2 负责安装登记，T3 负责将未使用的配件重新入库。所有三个事务执行完成后，T1 出库的数量应等于T2 安装的数量与 T3 重新入库的数量之和。数据项 I 记录配件的库存数量，数据项J 记录成功安装的数量。 某次组装过程出库了 12 个配件，安装了 6 个。假设数据库系统采用检查点机制对故障进行恢复，部分日志文件如表 5-1 所示。日志记录内容中： 表示事务Ti 开始执行，表示事务 Ti 提交，表示事务 Ti 将数据项 D 的值由V1 修改为V2。例如：表示事务 T1 将数据项 I 的数值从 22 修改为 3。表示将事务Ti 回滚，数据项D的值回滚到 V。 表示事务 Ti 回滚结束。CRASH 表示系统磁盘出错。请回答以下问题。

表 5-1 日志记录列表

| 日志记录编号 | 日志记录内容          |
| ------ | --------------- |
| LSN1   | <T1, START>     |
| LSN2   | <T1, I, 20, 8>  |
| LSN3   | <T2, START>     |
| LSN4   | <T2, J, 0, 1>   |
| LSN5   | <T2, J, 1, 5>   |
| LSN6   | <T3, START>     |
| LSN7   | <T2, J, 5, 6>   |
| LSN8   | <T1, COMMIT>    |
| LSN9   | CHECKPOINT      |
| LSN10  | <T2, COMMIT>    |
| LSN11  | <T3, I, 8, (a)> |
| LSN12  | CRASH           |
| LSN13  | (b)             |
| LSN14  | (c)             |


【问题 1】（5 分） 请用 100 字以内的文字简要说明数据库系统常见故障类型，并说明表5-1 中的日志记录表明数据库出现哪种类型的故障。
1. 事务故障：是由于程序执行错误而引起事务非预期的、异常终止的故障。
2. 系统故障：是指硬件故障、软件（DBMS、OS 或应用程序）漏洞的影响，导致丢失了内存中的信息，影响正在执行的事务，但未破坏存储在外存上的信息。
3. 介质故障：是指数据库的存储介质发生故障，如磁盘损坏，瞬间强磁场干扰等。
表 5-1 日志记录中的数据库出现介质故障。

【问题 2】（4 分） 请给出系统恢复时需要重做（Redo）的事务列表和需要撤销（Undo）的事务列表。
redo列表：T1
undo列表：T3

【问题 3】（6 分） 根据题干中所描述的业务逻辑，请填写表 5-1 日志记录中的空白(a)；请给出Undo 恢复的补偿日志记录，填写空白(b)和(c)。
a：14
b：<T3,I,8>
c：<T3,abort>
