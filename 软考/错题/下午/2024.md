试题一（25分）  
阅读下列说明，回答问题1至问题2，将解答填入答题纸的对应栏内。  
【说明】  
【说明】  
某快递公司对每个发出的快递进行跟踪管理，需要建立一个快递跟踪管理系统，对该公司承接的快递业务进行有效管理。  
【需求描述】  
1.公司在每个城市的每个街道都设有快递站点。这些站点负责快递的接收和投递。站点信息包括站点地址、站点名称、责任人、一部联系电话、开始营业时间、结束营业时间。每个站点每天的营业时间相同。每个站点只能有一个责任人。  
2.系统内需记录快递员、发件人的基本信息。这些信息包括姓名、身份证号、一个联系地址、一部联系电话。快递站点的责任人由快递员兼任，且每个快递站点只有一个责任人。每个快递员只负责一个快递站点的揽件和快递派送业务。发件人和快递员需实名认证。  
3.快递需要提供详实的信息，包括发件人姓名、身份证号、一部发件人电话号码、发件人地址、收件站点、收件人姓名、收件地址、一部收件人电话、投递时间、物品类别、物品名称及物品价值。每个发件人和收件人在系统里只能登记一个电话和地址。  
4.每个快递员接手一份快递后，需在系统中录入每个快递的当前状态信息，包括当前位置、收到时间、当前快递员和上一段快递员。状态信息包括待揽件、投递中、已签收。如果快递已签收，应记录签收人姓名及一个联系电话。每个快递在一个站点只能对应一个负责的快递员。  
注：试题不需要考虑快递退回的相关问题。  
【逻辑结构设计】  
根据上诉需求需求，设计出如下关系模式：  
快递（快递编号，收件人姓名，收件地址编号，收件人电话，投递时间，物品类别，物品名称，物品价值），其中收件地址编号是地址实体的地址编号。  
快递员（姓名，身份证号,电话号码，联系地址编号，工作站点编号）  
快递站点（站点编号，站点名称，责任人编号，站点地址编号，开始营业时间，联系电话，结束营业时间）。责任人编号是负责该站点的快递员的身份证号。  
地址（地址编号，所在省，所在市，所在街道，其他），其他信息是需补充的地址信息。  
快递投递（快递编号，快递员编号，发件人姓名，发件人身份证号，发件人电话号码，发件人地址编号），其中发件人地址编号为发件人地址的地址编号，揽件站点编号为接收该快递的站点编号。  
快递跟踪（快递编号，当前快递员编号，上一段快递员编号，当前状态，收到时间，当前站点编号）。  
快递签收（快递编号,签收人姓名，签收人联系电话）。  
  
【问题1】  
(6分)  
对关系“快递投递”，请回答以下问题：  
（ ） 列举出所有候选键。  
（ ） 它是否为3NF,用100字以内文字简要叙述理由。  
（ ） 将其分解为BCNF,分解后的关系名依次为：快递投递1,快递投递2，…，并用下划线标示分解后各关系模式的主键。  
  
【问题2】  
(6分)  
对关系“快递跟踪”，请回答以下问题：  
（ ） 列举出所有候选键。  
（ ） 它是否为2NF，用100字以内文字简要叙述理由。  
（ ） 将其分解为BCNF，分解后的关系名依次为：快递跟踪1，快递跟踪2，…，并用下划线标示分解后各关系模式的主键。  
  
【问题3】  
(3分)  
快递公司会根据快递物品和距离收取快递费，每件快递需由发件人或收件人支付快递费给公司。同一个发件人同时发起多个快递，必须分别支付。快递公司提供预支付和到付两种支付方式。为了统计快递费的支付情况(详细金额和时间)，试增加“快递费支付”关系模式，用100字以内文字简要叙述解决方案。


---

试题三（25分）  
阅读下列说明，回答问题1至问题2，将解答填入答题纸的对应栏内。  
【说明】  
某学校拟开发一套实验管理系统，对各课程的实验安排进行管理。  
【需求分析】  
每个实验室可进行的实验类型不同。由于实验室和实验员资源有限，需根据学生人数分批次安排实验室和实验员。一门含实验的课程可以开设给多个班级，每个班级每学期可以开设多门含实验的课程。每个实验室都有其可开设的实验类型。一门课程的一种实验可以根据人数、实验室的可容纳人数和实验室类型，分批次开设在多个实验室的不同时间段。一个实验室的一次实验可以分配多个实验员负责辅导实验，实验员给出学生的每次实验成绩。  
1.课程信息包括：课程编号、课程名称、实验学时、授课学期和开课的班级等信息；实验信息记录该课程的实验进度信息，包括：实验名、实验类型、学时、安排周次等信息，如表3-1所示。  
![](https://image-t.chaiding.com/ruankao/20250415/b6b9920990fb43a6be08da8df2a5310f.jpg)  
2.以课程为单位制定实验安排计划信息，•包括：实验地点，实验时间、实验员等信息。实验计划如表3-2所示。  
![](https://image-t.chaiding.com/ruankao/20250415/e3f63c5666824d52a591d46d9cb02895.jpg)  
3.由实验员给出每个学生每次实验的成绩，包括：实验名，学号，姓名，班级，实验成绩等信息。实验成绩如表3-3所示。  
![](https://image-t.chaiding.com/ruankao/20250415/35037627fc7948fc8b0416d1d1ca749c.jpg)  
4.学生的实验课程总成绩根据每次实验的成绩以及每次实验的难度来计算。  
【概念模型设计】  
根据需求阶段收集的信息，设计的实体联系图（不完整）如图3-1所示。  
![](https://image-t.chaiding.com/ruankao/20250415/54c07d428df1440eba164a95c79c9691.jpg)  
【逻辑结构设计】  
根据概念模型设计阶段完成的实体联系图,得出如下关系模式（不完整):  
![](https://image-t.chaiding.com/ruankao/20250415/9837e3b5dc3843b8998c60e580288da6.jpg)  
  
  
  
  
【问题1】  
补充图3-1中的联系和联系的类型。  
  
【问题2】  
如果需要记录课程的授课教师，新增加“授课教师”实体。请对图3-1进行修改，画出修改后的实体间联系和联系的类型。



---

试题二（25分）  
阅读下列说明，回答问题1至问题2，将解答填入答题纸的对应栏内。  
【说明】  
【说明】  
某工程项目管理系统的部分数据库关系模式如下：  
项目：PROJECT（Ino，Jname，City，Date），各属性分别表示项目代码、项目名称、项目所在城市和项目开始日期；  
零件：PART （Pno，Pname，Color，Sno，Stock），各属性分别表示零件代码、零件名称、零件颜色、零件所在仓库代码及库存量；  
供应情况：PJ（Pno，Jno，Qty），各属性分别表示零件代码、项目代码、使用量；  
仓库：STORE（Sno，Sname，Address），各属性分别表示仓库代码、仓库名称、仓库地址。  
有关上述关系模式的说明如下：  
（ ）下划线标出的属性是表的主键。  
（ ）零件表的属性Sno参照了仓库表的主码。一种零件只存放在一个仓库，库存量最低为0。  
（ ）供应情况表的属性Pno和Jno分别参照了零件表和项目表的主码。  
根据以上描述，回答下列问题，将SQL语句的空缺部分补充完整。  
  
【问题1】  
（4分）  
请将下面创建零件表PART的SQL语句补充完整，要求定义实体完整性约束、参照完整性约束，以及其他完整性约束。  
CREATE (a) PART(  
Pno CHAR（ ） (b)  
Pname CHAR（ ）,  
Color CHAR（ ）,  
Sno CHAR（ ） REFERENCES (c) (Sno)  
Stock INT (d) );  
  
【问题2】  
（3分）  
创建视图PARTUSED，给出在项目中已使用零件的代码和使用量。此视图的创建语句如下，请补全。  
CREATE VIEW PARTUSED AS SELECT Pno, (e) AS Usage FROM PJ (f) BY (g);


---

试题五（25分）  
阅读下列说明，回答问题1至问题2，将解答填入答题纸的对应栏内。  
【说明】  
某水果零售超市拟开发一套信息系统，对超市的顾客、水果、员工、采购和销售信息进行管理。  
  
![](https://image-t.chaiding.com/ruankao/20250415/8ff16fe129a2447e850ead0f4e165333.jpg)  
【需求分析】  
（ ）水果零售超市实行会员制，顾客需具有会员资格才能进行购物，顾客需持所在单位出具的证明信才能办理会员资格，每位顾客具有唯一编号。  
（ ）超市将采购员和导购员分成若干个小组，每组人员负责指定的若干种水果的采购和导购。每名采购员可采购指定给该组购买的水果；每名导购员都可对顾客选购的本组内的各种水果进行计价和包装，并分别贴上打印条码。  
（ ）顾客选购水果并计价完毕后进行结算，生成结算单。结算单包括流水号、购买的各种水果信息和顾客信息等，每张结算单具有唯一的流水号。  
（ ）超市在月底根据结算单对导购员进行绩效考核，根据采购情况对采购员进行考核，同时也根据结算单对顾客消费情况进行会员积分。  
初步设计的数据库关系模式如图4-1所示。  
![](https://image-t.chaiding.com/ruankao/20250415/73bc72c2077f40ccbc2898401d5b3ed5.jpg)  
图4-1数据库关系模式关系模式的主要属性，含义及约束如表4-1所示。  
表4-1主要属性，含义及约束  
![](https://image-t.chaiding.com/ruankao/20250415/85f6a1dce86a44648a576f2a1b79abd6.jpg)  
![](https://image-t.chaiding.com/ruankao/20250415/279bd73cc78e4de0bd114c5683d0bba4.jpg)  
  
【问题1】  
对关系模式“顾客”，请冋答以下问题：  
（ ）给出所有候选键。  
（ ）该关系模式可达到第几范式，用60字以内文字简要叙述理由。  
  
【问题2】  
对关系模式“结算单”，请回答以下问题：  
（ ）用100字以内文字简要说明它会产生什么问题。  
（ ）将其分解为第三范式，分解后的关系名依次为：结算单1，结算单2,…。并用下划线标注分解后的各关系模式的主键。


---

试题四（25分）  
阅读下列说明，回答问题1至问题2，将解答填入答题纸的对应栏内。  
【说明】  
（共15分）  
阅读下列说明，回答问题1至问题3,将解答填入答题纸的对应栏内。  
【说明】  
某高速路不停车收费系统（ETC)的业务描述如下：  
（ ）车辆驶入高速路入口站点时，将驶入信息（ETC卡号，入口编号，驶入时间） 写入登记表；  
（ ）车辆驶出高速路出口站点（收费口）时，将驶出信息（ETC卡号，出口编号， 驶出时间）写入登记表；根据入口编号、出口编号及相关收费标准，清算应缴费用，并从绑定的信用卡中扣除费用。  
一张ETC卡号只能绑定一张信用卡号，针对企业用户，一张信用卡号可以绑定多 个ETC卡号。使用表绑定（ETC卡号，信用卡号）来描述绑定关系，从信用卡（信用卡号，余额）表中扣除费用。  
针对上述业务描述，完成下列问题：  
  
【问题1】  
在不修改登记表的表结构和保留该表历史信息的前提下，当车辆驶入时，如何保 证当前ETC卡已经清算过，而在驶出时又如何保证该卡已驶入而未驶出？请用100 字以内文字简述处理方案。  
  
【问题2】  
当车辆驶出收费口时，从绑定信用卡余额中扣除费用的伪指令如下：读取信用卡余额到变量X，记为x = R(A)；扣除费用指令x = x - a;写信用卡余额指令记为W(A, x)。  
（ ）当两个绑定到同一信用卡号的车辆同时经过收费口时，可能的指令执行序列为：x1=R(A)，x1 =x1-a1, x2 = R(A), x2 = x2-a2, W(A，x1，W(A，x2)。此时会出现什么问题？（100字以内）  
（ ）为了解决上述问题，引入独占锁指令XLock(A)对数据A进行加锁，解锁指令Unlock(A)对数据A进行解锁。请补充上述执行序列，使其满足2PL协议。  
  
【问题3】  
下面是用E-SQL实现的费用扣除业务程序的一部分，请补全空缺处的代码。  
![](https://image-t.chaiding.com/ruankao/20250415/78606adebe514562ab11b97c357d92c2.jpg)


---

